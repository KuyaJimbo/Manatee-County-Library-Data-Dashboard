<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Library Service Value Calculator</title>
    <style>
        
    </style>
</head>
<body>
    <div class="container">
        <h1>Library Service Value Calculator</h1>
        <table>
            <thead>
                <tr>
                    <th>Quantity</th>
                    <th data-role="resizable">Service</th>
                    <th class="values-explained-column">Values Explained</th>
                    <th class="value-per-use-column">Value Per Use ($)</th>
                    <th>Value ($)</th>
                </tr>
            </thead>
            <tbody>
                                <tr>
                    <td><input data-product="books" value="0" min="0" type="text" /></td>
                    <td>Books Borrowed per Month</td>
                    <td class="values-explained-column values-explained">Reflects average cost of popular consumer eBooks (not free/public domain).</td>
                    <td class="value-per-use-column value-per-use-cell">$6.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="dvds" value="0" min="0" type="text" /></td>
                    <td>DVDs Borrowed per Month</td>
                    <td class="values-explained-column values-explained">Matches typical purchase cost for a new or recent DVD.</td>
                    <td class="value-per-use-column value-per-use-cell">$10.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="audiobooks" value="0" min="0" type="text" /></td>
                    <td>Audiobooks Borrowed per Month</td>
                    <td class="values-explained-column values-explained">Reflects average price for full-length audiobooks from Audible or publishers.</td>
                    <td class="value-per-use-column value-per-use-cell">$25.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="ebooks" value="0" min="0" type="text" /></td>
                    <td>eBooks Borrowed per Month</td>
                    <td class="values-explained-column values-explained">Reflects average cost of popular consumer eBooks (not free/public domain).</td>
                    <td class="value-per-use-column value-per-use-cell">$6.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="meeting-room" value="0" min="0" type="text" /></td>
                    <td>Meeting Room Usage Hours per Month</td>
                    <td class="values-explained-column values-explained">Based on hourly rental rates of comparable private meeting spaces in community centers.</td>
                    <td class="value-per-use-column value-per-use-cell">$30.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="study-room" value="0" min="0" type="text" /></td>
                    <td>Study Room Usage Hours per Month</td>
                    <td class="values-explained-column values-explained">Aligns with value of private study rooms or co-working quiet spaces per hour.</td>
                    <td class="value-per-use-column value-per-use-cell">$10.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="archive-lab" value="0" min="0" type="text" /></td>
                    <td>Archive Lab Usage Hours per Month</td>
                    <td class="values-explained-column values-explained">Based on commercial digitization services (VHS transfer, slide scanning, etc.) including staff support.</td>
                    <td class="value-per-use-column value-per-use-cell">$45.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="wifi" value="0" min="0" type="text" /></td>
                    <td>WiFi Use Hours per Month</td>
                    <td class="values-explained-column values-explained">Reflects value of secure high-speed internet access in public/commercial spaces.</td>
                    <td class="value-per-use-column value-per-use-cell">$4.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="online-learning" value="0" min="0" type="text" /></td>
                    <td>Online Learning Users per Month</td>
                    <td class="values-explained-column values-explained">Represents estimated monthly retail value of bundled premium services (e.g., LinkedIn Learning, Mango, Morningstar, PressReader, ProQuest).</td>
                    <td class="value-per-use-column value-per-use-cell">$25.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="research" value="0" min="0" type="text" /></td>
                    <td>Research Questions Asked per Month</td>
                    <td class="values-explained-column values-explained">Equivalent to hiring a research assistant or paying for a reference consultation.</td>
                    <td class="value-per-use-column value-per-use-cell">$15.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="technical-instructions-and-training" value="0" min="0" type="text" /></td>
                    <td>Technical Instructions and Training Hours per Month</td>
                    <td class="values-explained-column values-explained">Based on average hourly rate for adult education, digital literacy classes, or technology tutoring through community centers, workforce training, or commercial platforms.</td>
                    <td class="value-per-use-column value-per-use-cell">$25.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="computer-usage" value="0" min="0" type="text" /></td>
                    <td>Computer Use Hours per Month</td>
                    <td class="values-explained-column values-explained">Matches internet caf√©/computer rental rates per hour, especially with MS Office access.</td>
                    <td class="value-per-use-column value-per-use-cell">$12.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="program-child" value="0" min="0" type="text" /></td>
                    <td>Program/Class Attended per Month - Child</td>
                    <td class="values-explained-column values-explained">Estimated value based on costs for enrichment or storytime programs in community centers.</td>
                    <td class="value-per-use-column value-per-use-cell">$10.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="program-teen" value="0" min="0" type="text" /></td>
                    <td>Program/Class Attended per Month - Teen</td>
                    <td class="values-explained-column values-explained">Based on creative or educational teen-focused activities (e.g. coding, crafts).</td>
                    <td class="value-per-use-column value-per-use-cell">$13.00</td>
                    <td class="value-cell">$0.00</td>
                </tr>
                <tr>
                    <td><input data-product="program-adult" value="0" min="0" type="text" /></td>
                    <td>Program/Class Attended per Month - Adult</td>
                    <td class="values-explained-column values-explained">Reflects value of workshops, lectures, or adult education programs elsewhere.</td>
                    <td class="value-per-use-column value-per-use-cell">$17.50</td>
                    <td class="value-cell">$0.00</td>
                </tr>
            </tbody>
            <tfoot>
                <tr>
                    <th colspan="2">Total Value Received</th>
                    <th class="value-per-use-column"></th>
                    <th id="total-value">$0.00</th>
                </tr>
            </tfoot>
        </table>
        <div class="buttons-container">
            <h2>Load Fiscal Year Data</h2>
            <div class="fy-buttons-row"><button class="fy-button" type="button">FY 2022-23</button><button class="fy-button" type="button">FY 2023-24</button><button class="fy-button" type="button">FY 2024-25</button><button class="fy-button" type="button">FY 2025-26</button><button class="fy-button" type="button">FY 2026-27</button><button class="fy-button" type="button">FY 2027-28</button><button class="fy-button" type="button">FY 2028-29</button><button class="fy-button" type="button">FY 2029-30</button></div>
            <div class="control-buttons-row">
                <button class="clear-button" type="button">Clear All</button>
                <button class="toggle-explanation-button" type="button">Show How Service Values Were Calculated</button>
            </div>
        </div>
    </div>
    <script>
    const productValues = {
        "books": 6.00,
        "dvds": 10.00,
        "meeting-room": 30.00,
        "study-room": 10.00,
        "archive-lab": 45.00,
        "wifi": 4.00,
        "online-learning": 25.00,
        "research": 15.00,
        "technical-instructions-and-training": 25.00,
        "computer-usage": 12.00,
        "program-child": 10.00,
        "program-teen": 13.00,
        "program-adult": 17.50,
        "audiobooks": 25.00,
        "ebooks": 6.00
    };

    const fiscalYearData = {
        "2022-23": {
            "books": 331980,
            "dvds": 47917,
            "audiobooks": 194510,
            "ebooks": 716744,
            "meeting-room": 7823,
            "study-room": 15835,
            "archive-lab": 751,
            "wifi": 18551,
            "online-learning": 685927,
            "research": 208495,
            "technical-instructions-and-training": 5726,
            "computer-usage": 60190,
            "program-child": 22056,
            "program-teen": 1353,
            "program-adult": 16278
        },
        "2023-24": {
            "books": 368829,
            "dvds": 52443,
            "audiobooks": 238401,
            "ebooks": 867583,
            "meeting-room": 9694,
            "study-room": 19451,
            "archive-lab": 2797,
            "wifi": 19871,
            "online-learning": 817442,
            "research": 254036,
            "technical-instructions-and-training": 3075,
            "computer-usage": 62255,
            "program-child": 42807,
            "program-teen": 2450,
            "program-adult": 30959
        },
        "2024-25": {
            "books": 352678,
            "dvds": 55408,
            "audiobooks": 289231,
            "ebooks": 1103667,
            "meeting-room": 10507,
            "study-room": 9985,
            "archive-lab": 2026,
            "wifi": 18047,
            "online-learning": 757776,
            "research": 279464,
            "technical-instructions-and-training": 2694,
            "computer-usage": 49162,
            "program-child": 43739,
            "program-teen": 3347,
            "program-adult": 31806
        },
        "2025-26": {
            "books": 0,
            "dvds": 0,
            "audiobooks": 0,
            "ebooks": 0,
            "meeting-room": 0,
            "study-room": 0,
            "archive-lab": 0,
            "wifi": 0,
            "online-learning": 0,
            "research": 0,
            "technical-instructions-and-training": 0,
            "computer-usage": 0,
            "program-child": 0,
            "program-teen": 0,
            "program-adult": 0
        },
        "2026-27": {
            "books": 0,
            "dvds": 0,
            "audiobooks": 0,
            "ebooks": 0,
            "meeting-room": 0,
            "study-room": 0,
            "archive-lab": 0,
            "wifi": 0,
            "online-learning": 0,
            "research": 0,
            "technical-instructions-and-training": 0,
            "computer-usage": 0,
            "program-child": 0,
            "program-teen": 0,
            "program-adult": 0
        },
        "2027-28": {
            "books": 0,
            "dvds": 0,
            "audiobooks": 0,
            "ebooks": 0,
            "meeting-room": 0,
            "study-room": 0,
            "archive-lab": 0,
            "wifi": 0,
            "online-learning": 0,
            "research": 0,
            "technical-instructions-and-training": 0,
            "computer-usage": 0,
            "program-child": 0,
            "program-teen": 0,
            "program-adult": 0
        },
        "2028-29": {
            "books": 0,
            "dvds": 0,
            "audiobooks": 0,
            "ebooks": 0,
            "meeting-room": 0,
            "study-room": 0,
            "archive-lab": 0,
            "wifi": 0,
            "online-learning": 0,
            "research": 0,
            "technical-instructions-and-training": 0,
            "computer-usage": 0,
            "program-child": 0,
            "program-teen": 0,
            "program-adult": 0
        },
        "2029-30": {
            "books": 0,
            "dvds": 0,
            "audiobooks": 0,
            "ebooks": 0,
            "meeting-room": 0,
            "study-room": 0,
            "archive-lab": 0,
            "wifi": 0,
            "online-learning": 0,
            "research": 0,
            "technical-instructions-and-training": 0,
            "computer-usage": 0,
            "program-child": 0,
            "program-teen": 0,
            "program-adult": 0
        }
    };

    let inputs;
    let totalValueCell;
    let explanationColumns;
    let valuePerUseColumns;
    let toggleButton;
    let isExplanationVisible = false;

    function formatCurrency(value) {
        return "$" + value.toLocaleString('en-US', {minimumFractionDigits: 2, maximumFractionDigits: 2});
    }

    function formatNumberWithCommas(num) {
        return num.toLocaleString('en-US');
    }

    function parseNumberFromInput(value) {
        return parseInt(value.replace(/,/g, '')) || 0;
    }

    function formatInputValue(input) {
        const rawValue = input.value.replace(/,/g, '');
        const numValue = parseInt(rawValue) || 0;
        if (numValue > 0) {
            input.value = formatNumberWithCommas(numValue);
        } else {
            input.value = '';
        }
    }

    function calculate() {
        let total = 0;
        
        inputs.forEach(input => {
            const quantity = parseNumberFromInput(input.value);
            const product = input.getAttribute('data-product');
            const unitValue = productValues[product] || 0;
            const productTotal = quantity * unitValue;
            
            const valueCell = input.closest('tr').querySelector('.value-cell');
            valueCell.textContent = formatCurrency(productTotal);
            
            total += productTotal;
        });
        
        totalValueCell.textContent = formatCurrency(total);
    }

    function loadFiscalYear(year) {
        const data = fiscalYearData[year];
        if (data) {
            inputs.forEach(input => {
                const product = input.getAttribute('data-product');
                if (data.hasOwnProperty(product)) {
                    const currentValue = parseNumberFromInput(input.value);
                    animateValue(input, currentValue, data[product], 1500);
                }
            });
        }
    }

    function animateValue(input, start, end, duration) {
        const startTime = performance.now();
        
        function update() {
            const elapsed = performance.now() - startTime;
            const progress = Math.min(elapsed / duration, 1);
            
            const easeOut = 1 - Math.pow(1 - progress, 3);
            const current = Math.round(start + (end - start) * easeOut);
            
            input.value = formatNumberWithCommas(current);
            calculate();
            
            if (progress < 1) {
                requestAnimationFrame(update);
            }
        }
        
        requestAnimationFrame(update);
    }

    function clearAll() {
        inputs.forEach(input => {
            input.value = '';
        });
        calculate();
    }

    function toggleExplanation() {
        isExplanationVisible = !isExplanationVisible;

        explanationColumns.forEach(column => {
            column.classList.toggle('visible', isExplanationVisible);
        });

        valuePerUseColumns.forEach(column => {
            column.classList.toggle('visible', isExplanationVisible);
        });

        const totalRowFirstCell = document.querySelector('tfoot th:first-child');
        if (isExplanationVisible) {
            totalRowFirstCell.setAttribute('colspan', '3');
        } else {
            totalRowFirstCell.setAttribute('colspan', '2');
        }

        toggleButton.textContent = isExplanationVisible
            ? 'Hide How Service Values Were Calculated'
            : 'Show How Service Values Were Calculated';
    }

    function initializeCalculator() {
        inputs = document.querySelectorAll('input[data-product]');
        totalValueCell = document.getElementById('total-value');
        explanationColumns = document.querySelectorAll('.values-explained-column');
        valuePerUseColumns = document.querySelectorAll('.value-per-use-column');
        toggleButton = document.querySelector('.toggle-explanation-button');

        if (!inputs.length || !totalValueCell || !toggleButton) {
            setTimeout(initializeCalculator, 100);
            return;
        }

        inputs.forEach(input => {
            input.addEventListener('blur', function() {
                formatInputValue(this);
            });
            
            input.addEventListener('input', function() {
                calculate();
            });
            
            input.addEventListener('focus', function() {
                const rawValue = this.value.replace(/,/g, '');
                if (rawValue === '0') {
                    this.value = '';
                } else {
                    this.value = rawValue;
                }
            });
        });

        const fyButtons = document.querySelectorAll('.fy-button');
        fyButtons.forEach(button => {
            const buttonText = button.textContent.trim();
            let year = '';
            if (buttonText.includes('2022-23')) year = '2022-23';
            if (buttonText.includes('2023-24')) year = '2023-24';
            if (buttonText.includes('2024-25')) year = '2024-25';
            if (buttonText.includes('2025-26')) year = '2025-26';
            if (buttonText.includes('2026-27')) year = '2026-27';
            if (buttonText.includes('2027-28')) year = '2027-28';
            if (buttonText.includes('2028-29')) year = '2028-29';
            if (buttonText.includes('2029-30')) year = '2029-30';
            
            if (year) {
                button.addEventListener('click', function() {
                    loadFiscalYear(year);
                });
            }
        });

        const clearButton = document.querySelector('.clear-button');
        if (clearButton) {
            clearButton.addEventListener('click', clearAll);
        }

        toggleButton.addEventListener('click', toggleExplanation);

        calculate();
    }

    if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', initializeCalculator);
    } else {
        initializeCalculator();
    }

    window.addEventListener('load', function() {
        if (!inputs || !inputs.length) {
            initializeCalculator();
        }
    });
</script>
</body>
</html>