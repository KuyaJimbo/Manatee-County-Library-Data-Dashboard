<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manatee County Library System - Facilities Planning</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            color: #333;
            background: #f5f5f5;
        }

        .container {
            display: flex;
            min-height: 100vh;
        }

        /* Sidebar */
        .sidebar {
            width: 280px;
            background: white;
            padding: 20px;
            position: fixed;
            height: 100vh;
            overflow-y: auto;
            box-shadow: 2px 0 5px rgba(0,0,0,0.1);
        }

        .nav-section {
            margin-bottom: 30px;
        }

        .nav-section h3 {
            font-size: 14px;
            font-weight: 600;
            color: #666;
            margin-bottom: 12px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .nav-section ul {
            list-style: none;
        }

        .nav-section ul li {
            margin-bottom: 8px;
        }

        .nav-section ul li a {
            text-decoration: none;
            color: #0066cc;
            font-size: 14px;
            display: block;
            padding: 6px 0;
            transition: color 0.2s;
        }

        .nav-section ul li a:hover {
            color: #004499;
        }

        /* Main Content */
        .main-content {
            margin-left: 280px;
            flex: 1;
            padding: 40px;
            max-width: 1400px;
        }

        /* Hero Section */
        .hero {
            background: linear-gradient(135deg, #1e3a8a 0%, #3b82f6 100%);
            color: white;
            border-radius: 12px;
            padding: 60px;
            margin-bottom: 40px;
        }

        .hero h1 {
            font-size: 42px;
            margin-bottom: 20px;
        }

        .hero-content {
            display: grid;
            grid-template-columns: 1fr 300px;
            gap: 40px;
            align-items: center;
        }

        .hero-text {
            font-size: 18px;
            line-height: 1.6;
        }

        .hero-image {
            width: 100%;
            height: 200px;
            background: rgba(255,255,255,0.1);
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 14px;
        }

        .action-hero {
            background: white;
            color: #333;
            border-radius: 12px;
            padding: 40px 60px;
            margin-bottom: 40px;
            text-align: center;
        }

        .action-hero h2 {
            font-size: 32px;
            color: #1e3a8a;
        }

        /* Rounded Box */
        .rounded-box {
            background: white;
            border-radius: 12px;
            padding: 30px;
            margin-bottom: 30px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.08);
        }

        .section-title {
            font-size: 28px;
            color: #1e3a8a;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #3b82f6;
        }

        /* Two Column Layout */
        .two-col {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 30px;
            align-items: start;
        }

        .three-col {
            display: grid;
            grid-template-columns: 250px 1fr 300px;
            gap: 30px;
            align-items: start;
        }

        /* Map */
        .map-container {
            height: 400px;
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #ddd;
        }

        /* Location Info */
        .location-info {
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
        }

        .location-info h3 {
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 20px;
            margin-bottom: 15px;
            color: #1e3a8a;
        }

        .location-details {
            font-size: 14px;
            line-height: 1.8;
        }

        /* Service Buttons */
        .service-buttons {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }

        .service-btn {
            padding: 15px 20px;
            background: #f1f5f9;
            border: 2px solid transparent;
            border-radius: 8px;
            cursor: pointer;
            text-align: left;
            font-size: 15px;
            font-weight: 500;
            transition: all 0.3s;
        }

        .service-btn:hover {
            background: #e2e8f0;
        }

        .service-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #1e3a8a;
        }

        .service-description {
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
            line-height: 1.6;
        }

        .service-image {
            height: 250px;
            background: #e2e8f0;
            border-radius: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            color: #64748b;
        }

        /* Tab Buttons */
        .tab-buttons {
            display: flex;
            gap: 15px;
            margin-bottom: 30px;
        }

        .tab-btn {
            padding: 12px 30px;
            background: white;
            border: 2px solid #e2e8f0;
            border-radius: 8px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: all 0.3s;
        }

        .tab-btn:hover {
            background: #f8fafc;
        }

        .tab-btn.active {
            background: #3b82f6;
            color: white;
            border-color: #3b82f6;
        }

        /* Cards */
        .card-row {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin: 30px 0;
        }

        .card {
            background: linear-gradient(135deg, #f1f5f9 0%, #e2e8f0 100%);
            padding: 25px;
            border-radius: 10px;
            text-align: center;
            border: 2px solid #cbd5e1;
        }

        .card h4 {
            font-size: 14px;
            color: #64748b;
            margin-bottom: 10px;
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .card .value {
            font-size: 28px;
            font-weight: 700;
            color: #1e3a8a;
        }

        /* Chart */
        .chart-container {
            height: 400px;
            position: relative;
        }

        /* Form Section */
        .form-box {
            background: #f8fafc;
            padding: 20px;
            border-radius: 8px;
            margin-top: 15px;
        }

        .form-box input, .form-box textarea {
            width: 100%;
            padding: 12px;
            margin: 10px 0;
            border: 1px solid #cbd5e1;
            border-radius: 6px;
            font-family: inherit;
        }

        .submit-btn {
            background: #3b82f6;
            color: white;
            padding: 12px 30px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-size: 16px;
            font-weight: 600;
            transition: background 0.3s;
        }

        .submit-btn:hover {
            background: #1e3a8a;
        }

        /* Progress Bars */
        .progress-item {
            margin-bottom: 20px;
        }

        .progress-label {
            display: flex;
            justify-content: space-between;
            margin-bottom: 8px;
            font-size: 14px;
            font-weight: 600;
        }

        .progress-bar {
            height: 30px;
            background: #e2e8f0;
            border-radius: 15px;
            overflow: hidden;
        }

        .progress-fill {
            height: 100%;
            background: linear-gradient(90deg, #3b82f6 0%, #1e3a8a 100%);
            transition: width 0.5s ease;
            display: flex;
            align-items: center;
            padding-left: 15px;
            color: white;
            font-size: 13px;
            font-weight: 600;
        }

        /* Icons */
        .icon {
            display: inline-block;
            width: 24px;
            height: 24px;
        }

        .sources {
            margin-top: 20px;
            padding: 15px;
            background: #f1f5f9;
            border-radius: 6px;
            font-size: 13px;
            color: #64748b;
        }

        .timeline-content {
            padding: 20px;
            background: #f8fafc;
            border-radius: 8px;
        }

        .timeline-content ul {
            list-style-position: inside;
            line-height: 2;
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- Sidebar Navigation -->
        <div class="sidebar">
            <div class="nav-section">
                <h3>On This Page</h3>
                <ul>
                    <li><a href="#hero">Planning Overview</a></li>
                    <li><a href="#about">About Manatee Library</a></li>
                    <li><a href="#facilities">Facilities Planning</a></li>
                    <li><a href="#timeline">Timeline</a></li>
                    <li><a href="#building">What We're Building</a></li>
                    <li><a href="#population">Population vs Space</a></li>
                    <li><a href="#feedback">Community Feedback</a></li>
                </ul>
            </div>
            <div class="nav-section">
                <h3>Key Links</h3>
                <ul>
                    <li><a href="#library-map">Library Map</a></li>
                    <li><a href="#cip-map">Capital Improvement Map</a></li>
                    <li><a href="#population-chart">Population vs Sq. Ft.</a></li>
                </ul>
            </div>
        </div>

        <!-- Main Content -->
        <div class="main-content">
            <!-- Hero Section -->
            <section id="hero">
                <div class="hero">
                    <h1>Planning for a Strong Library</h1>
                    <div class="hero-content">
                        <div class="hero-text">
                            See where we are today, how we got here, and what's next. Share your ideas and follow progress in real time.
                        </div>
                        <div class="hero-image">
                            üìö Library Image
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 1: About Manatee Library -->
            <section id="about">
                <h2 class="section-title">About Manatee Library</h2>
                
                <div class="rounded-box">
                    <div class="two-col">
                        <div class="location-info">
                            <h3>
                                <span class="icon">üìç</span>
                                Our Libraries Today
                            </h3>
                            <p style="margin-bottom: 15px;"><strong>Branches, Special Facilities, Outreach</strong></p>
                            <div class="location-details" id="locationDetails">
                                Select a pinned location on the map to learn more
                            </div>
                        </div>
                        <div id="library-map" class="map-container"></div>
                    </div>
                </div>
                
                <div class="rounded-box">
                    <h3 style="font-size: 24px; margin-bottom: 15px;"> See Our Modern Libraries in Action</h3>
                    <div class="three-col">
                        <div class="service-buttons" id="serviceButtons">
                            <button class="service-btn active" data-service="learning">Learning Spaces</button>
                            <button class="service-btn" data-service="tech">Tech Support</button>
                            <button class="service-btn" data-service="meeting">Meeting Rooms</button>
                            <button class="service-btn" data-service="makerspace">Makerspace</button>
                            <button class="service-btn" data-service="study">Study Rooms</button>
                            <button class="service-btn" data-service="community">Community Rooms</button>
                            <button class="service-btn" data-service="programs">Programs</button>
                            <button class="service-btn" data-service="classes">Classes</button>
                        </div>
                        <div class="service-description" id="serviceDescription">
                            Modern learning spaces designed for collaboration, quiet study, and innovative learning experiences. Our facilities feature flexible furniture, natural lighting, and technology-enabled environments.
                        </div>
                        <div class="service-image">
                            üñºÔ∏è Service Image
                        </div>
                    </div>
                </div>
            </section>

            <!-- Section 2: Facilities Planning Overview -->
            <section id="facilities">
                <h2 class="section-title">Facilities Planning Overview</h2>
                
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="showTab('space')">Space Standards</button>
                    <button class="tab-btn" onclick="showTab('building')">Building Conditions</button>
                    <button class="tab-btn" onclick="showTab('service')">Service Gap</button>
                </div>

                <!-- Space Standards Tab -->
                <div id="spaceTab" class="rounded-box">
                    <h3 style="font-size: 24px; margin-bottom: 15px;">How Much Space Do We Need?</h3>
                    <p style="line-height: 1.6; margin-bottom: 30px;">
                        Experts often suggest about 0.6 sq. ft. of library space per resident (Florida Guideline). This helps size buildings for programs, seating, tech, and collections.
                    </p>

                    <div class="card-row">
                        <div class="card">
                            <h4>Manatee County Population</h4>
                            <div class="value">425,000</div>
                        </div>
                        <div class="card">
                            <h4>Current System Sq. Ft.</h4>
                            <div class="value">185,000</div>
                        </div>
                        <div class="card">
                            <h4>Per Capita (Current)</h4>
                            <div class="value">0.44</div>
                        </div>
                        <div class="card">
                            <h4>Recommended Sq. Ft.</h4>
                            <div class="value">255,000</div>
                        </div>
                        <div class="card">
                            <h4>Space Gap</h4>
                            <div class="value">70,000</div>
                        </div>
                    </div>

                    <div class="sources">
                        <strong>Sources:</strong> Florida Library Guidelines, U.S. Census Bureau, Manatee County Library System
                    </div>
                </div>

                <!-- Building Conditions Tab -->
                <div id="buildingTab" class="rounded-box" style="display: none;">
                    <h3 style="font-size: 24px; margin-bottom: 15px;">Infrastructure Snapshot</h3>
                    <p style="line-height: 1.6; margin-bottom: 30px;">
                        High-level look at age & needs
                    </p>

                    <div class="card-row">
                        <div class="card">
                            <h4>Carpeting</h4>
                            <div class="value" style="font-size: 18px;">Refresh Needed</div>
                        </div>
                        <div class="card">
                            <h4>HVAC</h4>
                            <div class="value" style="font-size: 18px;">Mixed/Aging</div>
                        </div>
                        <div class="card">
                            <h4>Accessibility</h4>
                            <div class="value" style="font-size: 18px;">Improvements Pending</div>
                        </div>
                    </div>

                    <div class="two-col" style="margin-top: 30px;">
                        <div class="location-info" id="buildingDetails">
                            <h4 style="margin-bottom: 15px;">Facility Conditions</h4>
                            <p>Select a library location on the map to view location-specific infrastructure needs and upcoming improvements.</p>
                        </div>
                        <div id="building-map" class="map-container"></div>
                    </div>

                    <div style="margin-top: 30px;">
                        <h4 style="margin-bottom: 15px;">Capital Improvement Projects</h4>
                        <div id="cip-map" class="map-container"></div>
                    </div>
                </div>

                <!-- Service Gap Tab -->
                <div id="serviceTab" class="rounded-box" style="display: none;">
                    <h3 style="font-size: 24px; margin-bottom: 15px;">Equity in Access</h3>
                    <p style="line-height: 1.6; margin-bottom: 30px;">
                        Who is within a 15-minute drive or transit? This interactive map helps to identify underserved areas and growth spots to guide future sites.
                    </p>
                    <div id="service-gap-map" class="map-container" style="height: 500px;"></div>
                </div>
            </section>

            <!-- Section 3: Timeline -->
            <section id="timeline">
                <h2 class="section-title">Timeline</h2>
                
                <div class="tab-buttons">
                    <button class="tab-btn active" onclick="showTimelineTab('history')">History</button>
                    <button class="tab-btn" onclick="showTimelineTab('today')">Today</button>
                    <button class="tab-btn" onclick="showTimelineTab('tomorrow')">Tomorrow</button>
                </div>

                <!-- History Tab -->
                <div id="historyTab" class="rounded-box">
                    <div class="timeline-content">
                        <ul>
                            <li>Founding legislation & milestone</li>
                            <li>Central Library & branch expansion</li>
                            <li>Bookmobile introduction</li>
                            <li><em>(Additional historical information to be provided)</em></li>
                        </ul>
                    </div>
                </div>

                <!-- Today Tab -->
                <div id="todayTab" class="rounded-box" style="display: none;">
                    <div class="timeline-content">
                        <h3 style="margin-bottom: 15px;">Current Operations</h3>
                        <p style="margin-bottom: 20px;">Visits, borrowing, digital usage</p>
                        <a href="https://app.powerbigov.us/view?r=eyJrIjoiMmU2MmVhNzEtY2Y4Yi00NWUzLTg2NTgtNmFiYjg4MDU3MmVkIiwidCI6ImNiZjE4NTg3LTc0MjItNDBmMi1hOGYyLWVhYTNhNGVhNDI0MCJ9&pageName=36bcde6e6c9f7f8b1db1" 
                           class="submit-btn" 
                           target="_blank" 
                           style="display: inline-block; text-decoration: none;">
                           View Library Public Dashboard ‚Üí
                        </a>

                    </div>
                </div>

                <!-- Tomorrow Tab -->
                <div id="tomorrowTab" class="rounded-box" style="display: none;">
                    <div class="timeline-content">
                        <h3 style="margin-bottom: 15px;">Future Plans</h3>
                        <ul>
                            <li>Renovations & Upgrades - recent / current</li>
                            <li>New Development Drive Time with Library local overlay</li>
                        </ul>
                    </div>
                </div>
            </section>

            <!-- Section 4: What We're Building -->
            <section id="building">
                <h2 class="section-title">What We Are Building For You</h2>
                
                <div class="rounded-box">
                    <h3 style="font-size: 24px; margin-bottom: 10px;">Interactive Service Map</h3>
                    <p style="margin-bottom: 20px; color: #64748b;">Drive times, Coverage, Growth Hotspots</p>
                    <div id="cip-projects-map" class="map-container" style="height: 500px;"></div>
                </div>
            </section>

            <!-- Section 5: Population vs Library Space -->
            <section id="population">
                <h2 class="section-title" id="population-chart">Population vs Library Space</h2>
                
                <div class="rounded-box">
                    <p style="margin-bottom: 20px; color: #64748b;">Simple chart comparing growth and space</p>
                    <div class="chart-container">
                        <canvas id="populationChart"></canvas>
                    </div>
                </div>
            </section>

            <!-- Section 6: Community Feedback -->
            <section id="feedback">
                <h2 class="section-title">Community Feedback</h2>
                
                <div class="two-col">
                    <!-- Column 1 -->
                    <div>
                        <div class="rounded-box">
                            <h3 style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                <span class="icon">üí¨</span>
                                Share Your Feedback
                            </h3>
                            <p style="margin-bottom: 20px;">Tell us your priorities</p>
                            
                            <div class="form-box">
                                <p style="margin-bottom: 15px;"><strong>Which improvements are most important to you?</strong></p>
                                <button class="submit-btn" onclick="openSurvey()">Take Survey</button>
                            </div>
                        </div>

                        <div class="rounded-box">
                            <h3 style="margin-bottom: 15px;">Comments</h3>
                            <p style="margin-bottom: 15px;">Share your thoughts and ideas</p>
                            <div class="form-box">
                                <textarea rows="4" placeholder="Enter your comments here..."></textarea>
                                <button class="submit-btn">Submit Comment</button>
                            </div>
                        </div>
                    </div>

                    <!-- Column 2 -->
                    <div>
                        <div class="rounded-box">
                            <h3 style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                                <span class="icon">üìã</span>
                                Milestone Tracker
                            </h3>
                            <p style="margin-bottom: 30px;">High Level Project Status</p>

                            <div class="progress-item">
                                <div class="progress-label">
                                    <span>Current Sq. Ft.</span>
                                    <span>73%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 73%;">185,000 / 255,000</div>
                                </div>
                            </div>

                            <div class="progress-item">
                                <div class="progress-label">
                                    <span>CIP Alignment</span>
                                    <span>45%</span>
                                </div>
                                <div class="progress-bar">
                                    <div class="progress-fill" style="width: 45%;">In Progress</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>

    <script>
        // Library locations data
        const libraryLocations = [
            { name: "Central Library", lat: 27.4989, lng: -82.5748, address: "1301 Barcarrota Blvd W, Bradenton, FL 34205", hours: "Mon-Thu: 9AM-8PM, Fri-Sat: 9AM-5PM, Sun: Closed" },
            { name: "Braden River Library", lat: 27.4167, lng: -82.4667, address: "4915 53rd Ave E, Bradenton, FL 34203", hours: "Mon-Thu: 10AM-7PM, Fri-Sat: 10AM-5PM, Sun: Closed" },
            { name: "Rocky Bluff Library", lat: 27.3833, lng: -82.4333, address: "6750 US-301, Ellenton, FL 34222", hours: "Mon-Thu: 10AM-7PM, Fri-Sat: 10AM-5PM, Sun: Closed" },
            { name: "Palmetto Library", lat: 27.5214, lng: -82.5723, address: "923 6th St W, Palmetto, FL 34221", hours: "Mon-Thu: 10AM-7PM, Fri-Sat: 10AM-5PM, Sun: Closed" },
            { name: "South Manatee Library", lat: 27.3333, lng: -82.4833, address: "6081 26th St W, Bradenton, FL 34207", hours: "Mon-Thu: 10AM-7PM, Fri-Sat: 10AM-5PM, Sun: Closed" }
        ];

        // Service descriptions
        const serviceData = {
            learning: "Modern learning spaces designed for collaboration, quiet study, and innovative learning experiences. Our facilities feature flexible furniture, natural lighting, and technology-enabled environments.",
            tech: "Free technology support including computer assistance, internet access, WiFi, printing services, and one-on-one tech help sessions. Staff available to help with devices, software, and digital resources.",
            meeting: "Professional meeting rooms available for community groups, businesses, and organizations. Rooms equipped with presentation technology, whiteboards, and flexible seating arrangements.",
            makerspace: "Creative spaces with 3D printers, crafting tools, sewing machines, and other equipment for hands-on learning and innovation. Programs include workshops and open creation time.",
            study: "Quiet study rooms for focused individual or group work. Reservable spaces with comfortable seating, good lighting, and power outlets for devices.",
            community: "Large community rooms for events, workshops, presentations, and gatherings. Available for public programs and community organization use.",
            programs: "Year-round programming for all ages including storytimes, book clubs, author talks, STEM activities, arts and crafts, and educational workshops.",
            classes: "Educational classes covering computer skills, job search assistance, language learning, financial literacy, and lifelong learning opportunities."
        };

        // Initialize maps
        let libraryMap, buildingMap, serviceGapMap, cipMap;

        function initMaps() {
            // Library locations map
            libraryMap = L.map('library-map').setView([27.4567, -82.5748], 11);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(libraryMap);

            libraryLocations.forEach(loc => {
                const marker = L.marker([loc.lat, loc.lng]).addTo(libraryMap);
                marker.on('click', () => {
                    document.getElementById('locationDetails').innerHTML = `
                        <strong>${loc.name}</strong><br>
                        ${loc.address}<br>
                        <em>${loc.hours}</em>
                    `;
                });
            });

            // Building conditions map
            buildingMap = L.map('building-map').setView([27.4567, -82.5748], 11);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(buildingMap);

            libraryLocations.forEach(loc => {
                const marker = L.marker([loc.lat, loc.lng]).addTo(buildingMap);
                marker.on('click', () => {
                    document.getElementById('buildingDetails').innerHTML = `
                        <h4>${loc.name} - Facility Needs</h4>
                        <p><strong>Carpeting:</strong> Scheduled for replacement 2026<br>
                        <strong>HVAC:</strong> System installed 2010, maintenance ongoing<br>
                        <strong>Accessibility:</strong> ADA compliant, minor improvements planned</p>
                    `;
                });
            });

            // CIP map
            cipMap = L.map('cip-map').setView([27.4567, -82.5748], 11);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(cipMap);

            libraryLocations.forEach(loc => {
                L.marker([loc.lat, loc.lng]).addTo(cipMap);
            });

            // Service gap map with circles
            serviceGapMap = L.map('service-gap-map').setView([27.4567, -82.5748], 10);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(serviceGapMap);

            libraryLocations.forEach(loc => {
                L.marker([loc.lat, loc.lng]).addTo(serviceGapMap);
                // 10-minute drive radius (approximately 5 miles)
                L.circle([loc.lat, loc.lng], {
                    color: '#3b82f6',
                    fillColor: '#3b82f6',
                    fillOpacity: 0.1,
                    radius: 8000
                }).addTo(serviceGapMap);
            });

            // CIP Projects map
            const cipProjectsMap = L.map('cip-projects-map').setView([27.4567, -82.5748], 11);
            L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                attribution: '¬© OpenStreetMap contributors'
            }).addTo(cipProjectsMap);

            libraryLocations.forEach(loc => {
                const marker = L.marker([loc.lat, loc.lng]).addTo(cipProjectsMap);
                marker.bindPopup(`<strong>${loc.name}</strong><br>CIP Status: Planning`);
            });
        }

        // Service button functionality
        document.getElementById('serviceButtons').addEventListener('click', (e) => {
            if (e.target.classList.contains('service-btn')) {
                document.querySelectorAll('.service-btn').forEach(btn => btn.classList.remove('active'));
                e.target.classList.add('active');
                
                const service = e.target.dataset.service;
                document.getElementById('serviceDescription').textContent = serviceData[service];
            }
        });

        // Tab switching functions
        function showTab(tab) {
            document.querySelectorAll('.tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.getElementById('spaceTab').style.display = tab === 'space' ? 'block' : 'none';
            document.getElementById('buildingTab').style.display = tab === 'building' ? 'block' : 'none';
            document.getElementById('serviceTab').style.display = tab === 'service' ? 'block' : 'none';

            if (tab === 'building') {
                setTimeout(() => {
                    buildingMap.invalidateSize();
                    cipMap.invalidateSize();
                }, 100);
            } else if (tab === 'service') {
                setTimeout(() => {
                    serviceGapMap.invalidateSize();
                }, 100);
            }
        }

        function showTimelineTab(tab) {
            document.querySelectorAll('#timeline .tab-btn').forEach(btn => btn.classList.remove('active'));
            event.target.classList.add('active');
            
            document.getElementById('historyTab').style.display = tab === 'history' ? 'block' : 'none';
            document.getElementById('todayTab').style.display = tab === 'today' ? 'block' : 'none';
            document.getElementById('tomorrowTab').style.display = tab === 'tomorrow' ? 'block' : 'none';
        }

        function openSurvey() {
            alert('Survey functionality - This would open a modal or external survey form with weighted multiple choice questions about library priorities.');
        }

        // Initialize chart
        function initChart() {
            const ctx = document.getElementById('populationChart').getContext('2d');
            new Chart(ctx, {
                type: 'line',
                data: {
                    labels: ['2000', '2005', '2010', '2015', '2020', '2025', '2030'],
                    datasets: [
                        {
                            label: 'Population (in thousands)',
                            data: [264, 290, 322, 360, 395, 425, 465],
                            borderColor: '#3b82f6',
                            backgroundColor: 'rgba(59, 130, 246, 0.1)',
                            yAxisID: 'y',
                            tension: 0.4
                        },
                        {
                            label: 'Square Footage (in thousands)',
                            data: [120, 135, 155, 165, 175, 185, 195],
                            borderColor: '#10b981',
                            backgroundColor: 'rgba(16, 185, 129, 0.1)',
                            yAxisID: 'y1',
                            tension: 0.4
                        },
                        {
                            label: 'Recommended Sq. Ft. (in thousands)',
                            data: [158, 174, 193, 216, 237, 255, 279],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            borderDash: [5, 5],
                            yAxisID: 'y1',
                            tension: 0.4
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    plugins: {
                        legend: {
                            position: 'top',
                        },
                        title: {
                            display: true,
                            text: 'Manatee County Population Growth vs Library Space'
                        }
                    },
                    scales: {
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            title: {
                                display: true,
                                text: 'Population (thousands)'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            title: {
                                display: true,
                                text: 'Square Footage (thousands)'
                            },
                            grid: {
                                drawOnChartArea: false,
                            }
                        }
                    }
                }
            });
        }

        // Initialize everything when page loads
        window.addEventListener('load', () => {
            initMaps();
            initChart();
        });

        // Smooth scrolling for navigation links
        document.querySelectorAll('a[href^="#"]').forEach(anchor => {
            anchor.addEventListener('click', function (e) {
                e.preventDefault();
                const target = document.querySelector(this.getAttribute('href'));
                if (target) {
                    target.scrollIntoView({
                        behavior: 'smooth',
                        block: 'start'
                    });
                }
            });
        });
    </script>
</body>
</html>